<!DOCTYPE html>
<html>
<head>
<meta charset=UTF-8>
<meta name=viewport content="width=device-width,initial-scale=1.0,user-scalable=no">
<title>授权码管理系统</title>
<style>
/* 原始样式完全保留，未做任何修改 */
*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif}
body{background:#f3f3f3;color:#333;padding:10px}
.generate-area{display:flex;gap:10px;margin:10px 0;align-items:center}
.generate-area select{flex:1;padding:6px;border:1px solid #ddd;border-radius:4px;font-size:14px}
button{background:#7d2ae8;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:14px;margin:0 2px}
button:hover{background:#6b23c2}
button.cancel{background:#dc3545}
button.cancel:hover{background:#bb2d3b}
button.restore{background:#28a745}
button.restore:hover{background:#218838}
.container{width:100%;overflow-x:auto}
table{width:100%;min-width:800px;border-collapse:collapse;margin:10px 0}
th,td{padding:8px 6px;text-align:left;border:1px solid #ddd;font-size:14px;word-break:break-word}
th{background:#e9d5ff;position:sticky;top:0;z-index:1}
.status{padding:2px 6px;border-radius:4px;color:#fff;font-size:12px;display:inline-block}
.unbound{background:#4ecdc4}/*未绑定（未激活）*/
.bound{background:#17a2b8}/*已绑定（激活中）*/
.expired{background:#ffc107;color:#333}/*已过期*/
.permanent{background:#7d2ae8}/*永久有效*/
.invalid{background:#dc3545}/*已取消（暂停）*/
input[type=text]{width:100%;padding:4px 6px;border:1px solid #ddd;border-radius:4px;font-size:13px}
</style>
</head>
<body>
<!-- 原始HTML结构完全保留，未做任何修改 -->
<div class=generate-area>
<select id=authType>
<option value=permanent>永久授权</option>
<option value=day>1天授权</option>
<option value=week>7天授权</option>
<option value=month>30天授权</option>
</select>
<button onclick="generateAuthCode()">生成授权码</button>
</div>
<div class=container>
<table>
<thead>
<tr>
<th>授权码</</th>
<th>状态</</th>
<th>时长</</th>
<th>到期时间</</th>
<th>本地随机码</</th>
<th>备注</</th>
<th>管理操作</</th>
</tr>
</thead>
<tbody id=authTableBody></tbody>
</table>
</div>

<script>
// 优化1：修复原始代码中函数嵌套导致的作用域问题，所有函数全局可访问
let authData = [];
const STORAGE_KEY = 'authSystemData';

// 生成授权码（原始逻辑保留，修复语法细节）
function generateAuthCode() {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    let code = '';
    for (let i = 0; i < 16; i++) {
        code += chars[Math.floor(Math.random() * chars.length)];
    }
    const type = document.getElementById('authType').value;
    const duration = type === 'permanent' ? '永久' : 
                   type === 'day' ? '1天' : 
                   type === 'week' ? '7天' : '30天';
    
    // 生成